<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aura AI Companion</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "@google/genai": "https://esm.sh/@google/genai"
      }
    }
    </script>
    <!-- Babel for JSX compilation in the browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Custom animations from components */
        @keyframes scan-y {
            0% { transform: translateY(0); }
            100% { transform: translateY(100vh); }
        }
        .animate-scan-y {
            animation: scan-y 3s linear;
        }

        @keyframes pulse-slow {
          0%, 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(0, 255, 255, 0.7); }
          70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(0, 255, 255, 0); }
        }
        @keyframes pulse-fast {
          0%, 100% { transform: scale(0.95); box-shadow: 0 0 0 5px rgba(0, 255, 255, 1); }
          50% { transform: scale(1.05); box-shadow: 0 0 0 20px rgba(0, 255, 255, 0); }
        }
        .animate-pulse-slow { animation: pulse-slow 4s infinite; }
        .animate-pulse-fast { animation: pulse-fast 1s infinite; }
        
        @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes spin-reverse-slow { from { transform: rotate(360deg); } to { transform: rotate(0deg); } }

        .animate-spin-slow { animation: spin-slow 20s linear infinite; }
        .animate-spin-reverse-slow { animation: spin-reverse-slow 30s linear infinite; }
    </style>
</head>
<body class="bg-black">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import ReactDOM from 'react-dom/client';
        import { GoogleGenAI, Chat, Type } from "@google/genai";

        // --- IMPORTANT ---
        // --- PASTE YOUR API KEY HERE ---
        const API_KEY = "PASTE_YOUR_GOOGLE_GEMINI_API_KEY_HERE";
        // --- IMPORTANT ---
        
        // =================================================================================
        // All Components and Hooks are defined below, in a single scope.
        // =================================================================================
        
        // --- From components/icons.tsx ---
        const CpuIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
            <path strokeLinecap="round" strokeLinejoin="round" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M12 6V3m0 18v-3M5.636 5.636l1.414 1.414m10.304 10.304l1.414 1.414M5.636 18.364l1.414-1.414m10.304-10.304l1.414-1.414M12 12a3 3 0 100-6 3 3 0 000 6z" />
          </svg>
        );

        const MemoryIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
            <path strokeLinecap="round" strokeLinejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
        );

        const StorageIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
            <path strokeLinecap="round" strokeLinejoin="round" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />
          </svg>
        );

        const TempIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
            <path strokeLinecap="round" strokeLinejoin="round" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        );

        const BatteryIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
            <path strokeLinecap="round" strokeLinejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V7.618a1 1 0 01.553-.894L9 4l5.447 2.724A1 1 0 0115 7.618v8.764a1 1 0 01-.553.894L9 20z" />
            <path strokeLinecap="round" strokeLinejoin="round" d="M21 12h-6" />
          </svg>
        );

        const MicrophoneIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2a3 3 0 0 0-3 3v6a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Zm-1 12.1A5.002 5.002 0 0 1 7 9V5a5 5 0 0 1 10 0v4a5.002 5.002 0 0 1-4 4.9V17h3a1 1 0 1 1 0 2H8a1 1 0 1 1 0-2h3v-2.9Z"/>
            </svg>
        );

        const SendIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} viewBox="0 0 24 24" fill="currentColor">
                <path d="M2.01 21 23 12 2.01 3 2 10l15 2-15 2 .01 7Z"/>
            </svg>
        );

        // --- From hooks/useSystemStats.ts ---
        const initialStats = {
          cpu: 15,
          memory: 30,
          storage: 78,
          temp: 55,
          battery: 92,
        };

        let batteryLevel = initialStats.battery;

        const useSystemStats = () => {
          const [stats, setStats] = useState(initialStats);

          useEffect(() => {
            const interval = setInterval(() => {
              batteryLevel = Math.max(0, batteryLevel - 0.01);

              setStats(prevStats => {
                const cpuSpike = Math.random() > 0.95 ? 30 : 0;
                const cpuChange = (Math.random() - 0.4) * 10;
                const newCpu = prevStats.cpu + cpuChange + cpuSpike;

                const memoryChange = (Math.random() - 0.5) * 5;
                const newMemory = prevStats.memory + memoryChange;
                
                const tempChange = (Math.random() - 0.5) * 2;
                const newTemp = prevStats.temp + tempChange;

                return {
                  ...prevStats,
                  cpu: Math.min(100, Math.max(5, newCpu)),
                  memory: Math.min(100, Math.max(20, newMemory)),
                  temp: Math.min(95, Math.max(45, newTemp)),
                  battery: batteryLevel,
                }
              });
            }, 2000);

            return () => clearInterval(interval);
          }, []);

          return {
            cpu: Math.round(stats.cpu),
            memory: Math.round(stats.memory),
            storage: Math.round(stats.storage),
            temp: Math.round(stats.temp),
            battery: Math.round(stats.battery),
          };
        };

        // --- From components/StatCard.tsx ---
        const StatCard = ({ icon, label, value, isStatic = false }) => {
          return (
            <div className="flex items-center justify-between p-2 bg-black bg-opacity-30 rounded">
              <div className="flex items-center space-x-3">
                {icon}
                <span className="text-sm tracking-wider text-gray-400">{label}</span>
              </div>
              <span className={`text-base font-semibold ${!isStatic ? 'text-white' : 'text-gray-300'}`}>
                {value}
              </span>
            </div>
          );
        };
        
        // --- From components/LeftPanel.tsx ---
        const LeftPanel = () => {
          const stats = useSystemStats();
          const [weather, setWeather] = useState(null);
          const [error, setError] = useState(null);

          useEffect(() => {
            const fetchWeather = (lat, lon) => {
              fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`)
                .then(res => res.json())
                .then(data => {
                  if (data.current_weather) {
                    setWeather({
                      temperature: data.current_weather.temperature,
                      description: 'Clear',
                    });
                  }
                })
                .catch(() => setError("Could not fetch weather data."));
            };
            
            navigator.geolocation.getCurrentPosition(
              (position) => {
                fetchWeather(position.coords.latitude, position.coords.longitude);
              },
              () => {
                setError("Location access denied.");
                fetchWeather(37.77, -122.42);
              }
            );
          }, []);

          return (
            <div className="h-full flex flex-col justify-between p-4 bg-gray-900 bg-opacity-50 border border-cyan-400/30 rounded-lg backdrop-blur-md">
              <div>
                <h2 className="text-cyan-400 text-lg tracking-widest mb-4">SYSTEM STATUS</h2>
                <div className="space-y-3">
                  <StatCard icon={<CpuIcon className="w-6 h-6 text-cyan-400"/>} label="CPU USAGE" value={`${stats.cpu}%`} />
                  <StatCard icon={<MemoryIcon className="w-6 h-6 text-cyan-400"/>} label="MEMORY" value={`${stats.memory}%`} />
                  <StatCard icon={<StorageIcon className="w-6 h-6 text-cyan-400"/>} label="STORAGE" value={`${stats.storage}%`} />
                  <StatCard icon={<TempIcon className="w-6 h-6 text-cyan-400"/>} label="CORE TEMP" value={`${stats.temp}°C`} />
                  <StatCard icon={<BatteryIcon className="w-6 h-6 text-cyan-400"/>} label="BATTERY" value={`${stats.battery}%`} />
                </div>
              </div>
              <div>
                <h2 className="text-cyan-400 text-lg tracking-widest mb-2">ENVIRONMENT</h2>
                {error && <p className="text-red-500">{error}</p>}
                {weather ? (
                  <p className="text-2xl">{weather.temperature}°C - LOCAL</p>
                ) : (
                  !error && <p className="animate-pulse">Fetching local weather...</p>
                )}
              </div>
            </div>
          );
        };

        // --- From components/RightPanel.tsx ---
        const RightPanel = () => {
          const [time, setTime] = useState(new Date());
          const [internetSpeed, setInternetSpeed] = useState({
              down: 431.2,
              up: 88.7
          });

          useEffect(() => {
            const timer = setInterval(() => setTime(new Date()), 1000);
            const speedTimer = setInterval(() => {
                setInternetSpeed(prevSpeed => {
                    const downFluctuation = (Math.random() - 0.5) * 20;
                    const upFluctuation = (Math.random() - 0.5) * 5;
                    const newDown = Math.max(100, Math.min(600, prevSpeed.down + downFluctuation));
                    const newUp = Math.max(20, Math.min(120, prevSpeed.up + upFluctuation));
                    return { down: newDown, up: newUp };
                });
            }, 2500);
            return () => {
                clearInterval(timer);
                clearInterval(speedTimer);
            };
          }, []);

          return (
            <div className="h-full flex flex-col p-4 bg-gray-900 bg-opacity-50 border border-cyan-400/30 rounded-lg backdrop-blur-md">
              <h2 className="text-cyan-400 text-lg tracking-widest mb-4">NETWORK & TIME</h2>
              <div className="text-5xl font-bold mb-6 text-center">
                {time.toLocaleTimeString()}
              </div>
              <div className="space-y-3">
                  <StatCard label="IP ADDRESS" value="192.168.1.101" isStatic={true} />
                  <StatCard label="WI-FI" value="AURA-NET-5G" isStatic={true} />
                  <StatCard label="INTERNET SPEED" value={`↓ ${internetSpeed.down.toFixed(1)} Mbps / ↑ ${internetSpeed.up.toFixed(1)} Mbps`} />
              </div>
            </div>
          );
        };
        
        // --- From components/WebcamFeed.tsx ---
        const WebcamFeed = () => {
          const videoRef = useRef(null);

          useEffect(() => {
            const enableStream = async () => {
              try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                if (videoRef.current) {
                  videoRef.current.srcObject = stream;
                }
              } catch (err) {
                console.error("Error accessing webcam: ", err);
              }
            };

            enableStream();

            return () => {
              if (videoRef.current && videoRef.current.srcObject) {
                const stream = videoRef.current.srcObject;
                stream.getTracks().forEach(track => track.stop());
              }
            };
          }, []);

          return (
            <div className="h-full w-full p-2 bg-gray-900 bg-opacity-50 border border-cyan-400/30 rounded-lg backdrop-blur-md flex flex-col">
              <h3 className="text-cyan-400 text-sm tracking-widest mb-2">VISUAL INPUT</h3>
              <div className="flex-grow rounded-md overflow-hidden">
                <video 
                  ref={videoRef} 
                  autoPlay 
                  muted 
                  className="w-full h-full object-cover transform scale-x-[-1]"
                ></video>
              </div>
            </div>
          );
        };
        
        // --- From components/AiCore.tsx ---
        const AiCore = ({ isThinking }) => {
          const thinkingClass = isThinking ? 'animate-pulse-fast' : 'animate-pulse-slow';

          return (
            <div className="absolute w-full h-full flex items-center justify-center opacity-30">
              <div className="relative w-64 h-64 md:w-80 md:h-80 flex items-center justify-center">
                <div className={`absolute w-full h-full border border-cyan-500/50 rounded-full animate-spin-reverse-slow ${isThinking ? 'animation-duration-10s' : ''}`}></div>
                <div className={`absolute w-2/3 h-2/3 border border-cyan-500/70 rounded-full animate-spin-slow ${isThinking ? 'animation-duration-5s' : ''}`}></div>
                <div className={`w-1/2 h-1/2 bg-cyan-500/20 rounded-full ${thinkingClass}`}></div>
              </div>
            </div>
          );
        };
        
        // --- From components/ChatDisplay.tsx ---
        const ChatDisplay = ({ messages }) => {
          const endOfMessagesRef = useRef(null);

          useEffect(() => {
            endOfMessagesRef.current?.scrollIntoView({ behavior: 'smooth' });
          }, [messages]);

          const renderMessage = (msg) => {
            const baseClass = "max-w-xs md:max-w-md lg:max-w-lg p-3 rounded-lg text-sm";
            
            switch (msg.role) {
              case 'user':
                return (
                  <div key={msg.id} className="flex justify-end mb-3">
                    <div className={`${baseClass} bg-cyan-800 bg-opacity-50`}>
                      {msg.text}
                    </div>
                  </div>
                );
              case 'model':
                return (
                  <div key={msg.id} className="flex justify-start mb-3">
                    <div className={`${baseClass} bg-gray-700 bg-opacity-50`}>
                      <span className="font-bold text-cyan-400 block mb-1">Aura:</span>
                      {msg.text}
                    </div>
                  </div>
                );
              case 'system':
                return (
                  <div key={msg.id} className="text-center my-2">
                    <p className="text-xs text-red-500 italic tracking-wider">{msg.text}</p>
                  </div>
                );
               case 'tool':
                return (
                  <div key={msg.id} className="text-center my-2">
                    <p className="text-xs text-yellow-400 italic tracking-wider">[ {msg.text} ]</p>
                  </div>
                );
              default:
                return null;
            }
          };

          return (
            <div className="h-full w-full overflow-y-auto pr-2">
              {messages.map(renderMessage)}
              <div ref={endOfMessagesRef} />
            </div>
          );
        };
        
        // --- From components/CommandInput.tsx ---
        const CommandInput = ({ onSendMessage, isLoading }) => {
          const [inputText, setInputText] = useState('');
          const [isListening, setIsListening] = useState(false);
          const recognitionRef = useRef(null);
          const transcriptRef = useRef('');

          const onSendMessageRef = useRef(onSendMessage);
          useEffect(() => {
            onSendMessageRef.current = onSendMessage;
          }, [onSendMessage]);

          useEffect(() => {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (SpeechRecognition) {
              const recognition = new SpeechRecognition();
              recognition.continuous = false;
              recognition.interimResults = true;
              recognition.lang = 'en-US';

              recognition.onresult = (event) => {
                const transcript = Array.from(event.results)
                  .map(result => result[0])
                  .map(result => result.transcript)
                  .join('');
                transcriptRef.current = transcript;
                setInputText(transcript);
              };
              
              recognition.onend = () => {
                setIsListening(false);
                if (transcriptRef.current.trim()) {
                    onSendMessageRef.current(transcriptRef.current.trim());
                }
                setInputText('');
                transcriptRef.current = '';
              };

              recognition.onerror = (event) => {
                if (event.error === 'no-speech' || event.error === 'aborted') {
                  console.log("Speech recognition stopped: User was silent or aborted the action.");
                } else if (event.error === 'network') {
                  console.log("Speech recognition failed: A network error occurred.");
                } else {
                  console.error(`Speech recognition error: ${event.error} - ${event.message}`);
                }
              };

              recognitionRef.current = recognition;
            }
          }, []);

          const handleMicClick = () => {
            if (!recognitionRef.current) return;

            if (isListening) {
              recognitionRef.current.stop();
            } else {
              setInputText('');
              transcriptRef.current = '';
              recognitionRef.current.start();
              setIsListening(true);
            }
          };

          const handleSendMessage = () => {
            if (inputText.trim()) {
              onSendMessage(inputText);
              setInputText('');
            }
          };

          const handleKeyDown = (e) => {
            if (e.key === 'Enter') {
              handleSendMessage();
            }
          };

          return (
            <div className="h-full w-full flex flex-col p-4 bg-gray-900 bg-opacity-50 border border-cyan-400/30 rounded-lg backdrop-blur-md">
              <div className="flex-grow relative flex items-center">
                <input
                  type="text"
                  value={inputText}
                  onChange={(e) => setInputText(e.target.value)}
                  onKeyDown={handleKeyDown}
                  placeholder={isListening ? "Listening..." : "Enter command or ask a question..."}
                  disabled={isLoading}
                  className="w-full h-12 bg-black bg-opacity-50 border border-cyan-400/50 rounded-lg pl-4 pr-24 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-400 transition-all"
                />
                <div className="absolute right-2 flex items-center space-x-2">
                    <button
                        onClick={handleMicClick}
                        className={`p-2 rounded-full transition-colors ${isListening ? 'bg-red-500 animate-pulse' : 'bg-cyan-600 hover:bg-cyan-500'}`}
                        aria-label="Toggle voice command"
                    >
                        <MicrophoneIcon className="w-6 h-6 text-white"/>
                    </button>
                    <button
                        onClick={handleSendMessage}
                        disabled={isLoading || !inputText.trim()}
                        className="p-2 rounded-full bg-cyan-600 hover:bg-cyan-500 disabled:bg-gray-600 disabled:opacity-50 transition-colors"
                        aria-label="Send message"
                    >
                        <SendIcon className="w-6 h-6 text-white" />
                    </button>
                </div>
              </div>
              {isLoading && <p className="text-center text-cyan-400 animate-pulse mt-2 text-sm">Aura is thinking...</p>}
            </div>
          );
        };
        
        // --- From components/MainInterface.tsx ---
        const MainInterface = () => {
          const [messages, setMessages] = useState([]);
          const [isLoading, setIsLoading] = useState(false);
          const chatRef = useRef(null);
          const genAI = useRef(null);

          useEffect(() => {
            const initializeChat = async () => {
              if (!API_KEY || API_KEY === "PASTE_YOUR_GOOGLE_GEMINI_API_KEY_HERE") {
                const errorMessage = {
                    id: 'aura-error',
                    role: 'system',
                    text: 'Error: API key not provided. Please edit the HTML file to add your Gemini API key.',
                    timestamp: new Date().toLocaleTimeString(),
                };
                setMessages([errorMessage]);
                return;
              }

              try {
                genAI.current = new GoogleGenAI({ apiKey: API_KEY });
                
                const openWebsiteFunction = {
                  functionDeclarations: [
                    {
                      name: 'openWebsite',
                      description: 'Opens a specified website in a new browser tab.',
                      parameters: {
                        type: Type.OBJECT,
                        properties: {
                          url: {
                            type: Type.STRING,
                            description: 'The valid URL to open, e.g., "google.com".',
                          },
                        },
                        required: ['url'],
                      },
                    },
                  ],
                };

                chatRef.current = genAI.current.chats.create({
                  model: "gemini-2.5-flash",
                  tools: [openWebsiteFunction],
                });

                const welcomeMessage = {
                    id: 'aura-welcome',
                    role: 'model',
                    text: 'Aura OS is online. All systems nominal. How can I assist you?',
                    timestamp: new Date().toLocaleTimeString(),
                };
                setMessages([welcomeMessage]);

              } catch (error) {
                console.error("Failed to initialize Gemini AI:", error);
                const errorMessage = {
                    id: 'aura-error',
                    role: 'system',
                    text: `Error connecting to AI core: ${error.message}. Check API key and network.`,
                    timestamp: new Date().toLocaleTimeString(),
                };
                setMessages([errorMessage]);
              }
            };
            initializeChat();
          }, []);

          const handleSendMessage = async (text) => {
            if (!text.trim() || isLoading || !chatRef.current) return;

            const userMessage = {
              id: `user-${Date.now()}`,
              role: 'user',
              text,
              timestamp: new Date().toLocaleTimeString(),
            };
            setMessages(prev => [...prev, userMessage]);
            setIsLoading(true);

            try {
              // 1. Send the user message and get the initial response
              const result = await chatRef.current.sendMessage({ message: text });
              const response = result;

              // 2. Check for function calls
              const functionCalls = response.functionCalls;
              if (functionCalls && functionCalls.length > 0) {
                const functionResponses = [];

                for (const fc of functionCalls) {
                  if (fc.name === 'openWebsite') {
                    const url = fc.args.url;
                    if (typeof url === 'string') {
                        const toolMessage = {
                            id: `tool-${Date.now()}`,
                            role: 'tool',
                            text: `Executing: Opening ${url}`,
                            timestamp: new Date().toLocaleTimeString(),
                        };
                        setMessages(prev => [...prev, toolMessage]);
                        window.open(url.startsWith('http') ? url : `https://${url}`, '_blank');
                        
                        functionResponses.push({
                            functionResponse: {
                                name: 'openWebsite',
                                response: { result: "Successfully opened " + url },
                            },
                        });
                    }
                  }
                }

                // 3. Send function responses back to the model
                const funcResponseResult = await chatRef.current.sendMessage({
                    parts: functionResponses
                });
                
                // 4. Get the final text response from the model
                const finalResponse = funcResponseResult;
                const modelResponse = {
                    id: `model-${Date.now()}`,
                    role: 'model',
                    text: finalResponse.text,
                    timestamp: new Date().toLocaleTimeString(),
                };
                setMessages(prev => [...prev, modelResponse]);
              } else {
                // No function call, just a regular text response
                const modelResponse = {
                    id: `model-${Date.now()}`,
                    role: 'model',
                    text: response.text,
                    timestamp: new Date().toLocaleTimeString(),
                };
                setMessages(prev => [...prev, modelResponse]);
              }

            } catch (error) {
                console.error("Gemini API call failed:", error);
                const errorMessage = {
                    id: `error-${Date.now()}`,
                    role: 'system',
                    text: 'An error occurred while communicating with the AI. Please try again.',
                    timestamp: new Date().toLocaleTimeString(),
                };
                setMessages(prev => [...prev, errorMessage]);
            } finally {
                setIsLoading(false);
            }
          };

          return (
            <div className="h-screen w-screen p-4 grid grid-cols-12 grid-rows-6 gap-4 bg-black bg-opacity-90 backdrop-blur-sm">
                <div className="col-span-3 row-span-6">
                    <LeftPanel />
                </div>
                <div className="col-span-6 row-span-4 flex items-center justify-center relative">
                    <AiCore isThinking={isLoading} />
                    <div className="absolute inset-0 z-10 p-4 overflow-y-auto">
                        <ChatDisplay messages={messages} />
                    </div>
                </div>
                <div className="col-span-6 row-span-2">
                    <CommandInput onSendMessage={handleSendMessage} isLoading={isLoading} />
                </div>
                <div className="col-span-3 row-span-4">
                    <RightPanel />
                </div>
                <div className="col-span-3 row-span-2">
                    <WebcamFeed />
                </div>
            </div>
          );
        };
        
        // --- From components/AuthScreen.tsx ---
        const AuthScreen = ({ onAuthenticated }) => {
          const videoRef = useRef(null);
          const [scanActive, setScanActive] = useState(false);
          const [authText, setAuthText] = useState("Awaiting Biometric Confirmation");

          useEffect(() => {
            const startCamera = async () => {
              try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                if (videoRef.current) {
                  videoRef.current.srcObject = stream;
                }
              } catch (err) {
                console.error("Error accessing camera:", err);
                setAuthText("Camera Access Denied. Please enable camera permissions.");
              }
            };
            startCamera();
            return () => {
              if (videoRef.current && videoRef.current.srcObject) {
                const stream = videoRef.current.srcObject;
                stream.getTracks().forEach(track => track.stop());
              }
            };
          }, []);

          const handleAuth = () => {
            setScanActive(true);
            setAuthText("Scanning...");
            setTimeout(() => {
              setAuthText("Biometrics Verified. Welcome, User.");
              setTimeout(onAuthenticated, 1500);
            }, 3000);
          };

          return (
            <div className="flex flex-col items-center justify-center h-screen bg-black text-cyan-300 font-mono">
              <h1 className="text-3xl mb-4 tracking-widest animate-pulse">AURA - SECURE ACCESS</h1>
              <div className="relative w-80 h-80 md:w-96 md:h-96 rounded-full overflow-hidden border-2 border-cyan-400 shadow-[0_0_20px_rgba(0,255,255,0.5)]">
                <video ref={videoRef} autoPlay muted className="w-full h-full object-cover transform scale-x-[-1]"></video>
                {scanActive && (
                  <div className="absolute top-0 left-0 w-full h-full">
                    <div className="h-1 bg-cyan-400 animate-scan-y"></div>
                  </div>
                )}
              </div>
              <p className="mt-6 text-lg">{authText}</p>
              <button 
                onClick={handleAuth}
                disabled={scanActive}
                className="mt-4 px-8 py-3 border border-cyan-400 text-cyan-400 uppercase tracking-widest
                           hover:bg-cyan-400 hover:text-black transition-all duration-300
                           disabled:opacity-50 disabled:cursor-not-allowed"
              >
                Authenticate
              </button>
            </div>
          );
        };
        
        // --- From App.tsx ---
        const App = () => {
          const [isAuthenticated, setIsAuthenticated] = useState(false);
          const [isLoading, setIsLoading] = useState(true);

          useEffect(() => {
            const timer = setTimeout(() => setIsLoading(false), 2000);
            return () => clearTimeout(timer);
          }, []);
          
          const handleAuthentication = () => {
            setIsAuthenticated(true);
          };

          if (isLoading) {
            return (
              <div className="flex items-center justify-center h-screen bg-black text-cyan-400 font-mono">
                <div className="animate-pulse text-2xl tracking-widest">INITIALIZING AURA OS...</div>
              </div>
            );
          }

          return (
            <div className="w-full h-screen bg-black text-white font-mono overflow-hidden">
              {!isAuthenticated ? (
                <AuthScreen onAuthenticated={handleAuthentication} />
              ) : (
                <MainInterface />
              )}
            </div>
          );
        };
        
        // --- From index.tsx ---
        const rootElement = document.getElementById('root');
        if (!rootElement) {
          throw new Error("Could not find root element to mount to");
        }

        const root = ReactDOM.createRoot(rootElement);
        root.render(
          <React.StrictMode>
            <App />
          </React.StrictMode>
        );

    </script>
</body>
</html>